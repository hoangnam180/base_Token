{
    "sourceFile": "src/middlewares/auth.middlewares.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 60,
            "patches": [
                {
                    "date": 1658163385479,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1658163403937,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,3 +1,6 @@\n const requireAuth = (req, res, next) => {\r\n-\r\n+    if (req.isAuthenticated()) {\r\n+        return next();\r\n+    }\r\n+    res.redirect('/admin/login');\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163580716,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,5 @@\n const requireAuth = (req, res, next) => {\r\n-    if (req.isAuthenticated()) {\r\n-        return next();\r\n-    }\r\n-    res.redirect('/admin/login');\r\n-}\n\\ No newline at end of file\n+\r\n+}\r\n+\r\n+module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163801917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,7 @@\n const requireAuth = (req, res, next) => {\r\n-\r\n+    if (!req.cookies.email) {\r\n+        res.redirect('admin/login');\r\n+    }\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163814313,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,8 @@\n const requireAuth = (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('admin/login');\r\n+        res.redirect('admin');\r\n+        return;\r\n     }\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163830719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,7 +2,8 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n+\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163922537,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,11 @@\n+import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-\r\n+    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n+    next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658163935555,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    next();\r\n+    // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n+    // next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164022565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    // next();\r\n+    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n+    next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164043583,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,10 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n+\r\n+    // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n     next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164053093,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-\r\n+    console.log(req.cookies.email);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n     next();\r\n }\r\n \r\n"
                },
                {
                    "date": 1658164122065,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    console.log(req.cookies.email);\r\n+    console.log(req.cookies);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n     next();\r\n }\r\n \r\n"
                },
                {
                    "date": 1658164140023,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,8 @@\n         return;\r\n     }\r\n     console.log(req.cookies);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    next();\r\n+\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164168412,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,10 +1,10 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n-    if (!req.cookies.email) {\r\n-        res.redirect('admin');\r\n-        return;\r\n-    }\r\n+    // if (!req.cookies.email) {\r\n+    //     res.redirect('admin');\r\n+    //     return;\r\n+    // }\r\n     console.log(req.cookies);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n \r\n }\r\n"
                },
                {
                    "date": 1658164182959,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     // if (!req.cookies.email) {\r\n     //     res.redirect('admin');\r\n     //     return;\r\n     // }\r\n-    console.log(req.cookies);\r\n+    console.log(\"check req>>>\", req.cookies);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n \r\n }\r\n \r\n"
                },
                {
                    "date": 1658164201111,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     // if (!req.cookies.email) {\r\n     //     res.redirect('admin');\r\n     //     return;\r\n     // }\r\n-    console.log(\"check req>>>\", req.cookies);\r\n+    console.log(\"check req>>>\", req);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n \r\n }\r\n \r\n"
                },
                {
                    "date": 1658164239388,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n     // if (!req.cookies.email) {\r\n     //     res.redirect('admin');\r\n     //     return;\r\n     // }\r\n-    console.log(\"check req>>>\", req);\r\n+    console.log(\"check req>>>\", req.cookie);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n \r\n }\r\n \r\n"
                },
                {
                    "date": 1658164385090,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,8 @@\n     //     return;\r\n     // }\r\n     console.log(\"check req>>>\", req.cookie);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-\r\n+    next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164466020,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,8 @@\n     //     return;\r\n     // }\r\n     console.log(\"check req>>>\", req.cookie);\r\n     // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    next();\r\n+    // next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164557294,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n+    console.log(req.cookies.email);\r\n     // if (!req.cookies.email) {\r\n     //     res.redirect('admin');\r\n     //     return;\r\n     // }\r\n"
                },
                {
                    "date": 1658164788904,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n-    console.log(req.cookies.email);\r\n+    console.log(req.cookies);\r\n     // if (!req.cookies.email) {\r\n     //     res.redirect('admin');\r\n     //     return;\r\n     // }\r\n"
                },
                {
                    "date": 1658164864974,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,15 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n-    console.log(req.cookies);\r\n-    // if (!req.cookies.email) {\r\n-    //     res.redirect('admin');\r\n-    //     return;\r\n-    // }\r\n-    console.log(\"check req>>>\", req.cookie);\r\n-    // const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    // next();\r\n+    console.log(req.cookies.email);\r\n+    if (!req.cookies.email) {\r\n+        res.redirect('admin');\r\n+        return;\r\n+    }\r\n+    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n+    if (rows.length === 0) {\r\n+        res.render('admin/login', { data: rows[0] })\r\n+    }\r\n+    next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658164912630,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = (req, res, next) => {\r\n-    console.log(req.cookies.email);\r\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658165009743,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,12 +3,17 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    const [rows] = await pool.execute(`SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`);\r\n-    if (rows.length === 0) {\r\n-        res.render('admin/login', { data: rows[0] })\r\n-    }\r\n-    next();\r\n+    const [rows] = await pool.execute('SELECT * FROM thanhvien WHERE email = ?', [req.cookies.email]);\r\n+    console.log(rows);\r\n+    // if (rows.length === 0) {\r\n+    //     res.render('admin/login', { data: rows[0] })\r\n+    // }\r\n+    // next();\r\n+    // next();\r\n+\r\n+\r\n+\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658165044127,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,10 +3,10 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    const [rows] = await pool.execute('SELECT * FROM thanhvien WHERE email = ?', [req.cookies.email]);\r\n-    console.log(rows);\r\n+    // const [rows] = await pool.execute('SELECT * FROM thanhvien WHERE email = ?', [req.cookies.email]);\r\n+    // console.log(rows);\r\n     // if (rows.length === 0) {\r\n     //     res.render('admin/login', { data: rows[0] })\r\n     // }\r\n     // next();\r\n"
                },
                {
                    "date": 1658165088107,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,13 +3,21 @@\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n-    // const [rows] = await pool.execute('SELECT * FROM thanhvien WHERE email = ?', [req.cookies.email]);\r\n-    // console.log(rows);\r\n-    // if (rows.length === 0) {\r\n-    //     res.render('admin/login', { data: rows[0] })\r\n-    // }\r\n+    const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n+    pool.execute(sql).then(result => {\r\n+        if (result[0].length > 0 && result[0][0].quyen_truy_cap === 2) {\r\n+            next();\r\n+        }\r\n+        else {\r\n+            res.redirect('admin');\r\n+        }\r\n+    }\r\n+    ).catch(err => {\r\n+        console.log(err);\r\n+    }\r\n+    )\r\n     // next();\r\n     // next();\r\n \r\n \r\n"
                },
                {
                    "date": 1658165138123,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,8 +5,9 @@\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     pool.execute(sql).then(result => {\r\n+        console.log(result[0][0]);\r\n         if (result[0].length > 0 && result[0][0].quyen_truy_cap === 2) {\r\n             next();\r\n         }\r\n         else {\r\n"
                },
                {
                    "date": 1658165225595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,21 +4,10 @@\n         res.redirect('admin');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n-    pool.execute(sql).then(result => {\r\n-        console.log(result[0][0]);\r\n-        if (result[0].length > 0 && result[0][0].quyen_truy_cap === 2) {\r\n-            next();\r\n-        }\r\n-        else {\r\n-            res.redirect('admin');\r\n-        }\r\n-    }\r\n-    ).catch(err => {\r\n-        console.log(err);\r\n-    }\r\n-    )\r\n+    const [rows] = await pool.execute(sql);\r\n+    console.log(rows);\r\n     // next();\r\n     // next();\r\n \r\n \r\n"
                },
                {
                    "date": 1658165234337,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,12 +6,8 @@\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.execute(sql);\r\n     console.log(rows);\r\n-    // next();\r\n-    // next();\r\n-\r\n-\r\n-\r\n+    next();\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658165284356,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,9 +4,9 @@\n         res.redirect('admin');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n-    const [rows] = await pool.execute(sql);\r\n+    const [rows] = await pool.query(sql);\r\n     console.log(rows);\r\n     next();\r\n }\r\n \r\n"
                },
                {
                    "date": 1658165313288,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,6 @@\n import pool from '../config/connectDatabase'\r\n-const requireAuth = (req, res, next) => {\r\n+const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n         res.redirect('admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658165350756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,10 @@\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n-    console.log(rows);\r\n-    next();\r\n+    if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n+        next();\r\n+    }\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658165364140,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n-        next();\r\n+        next(rows[0]);\r\n     }\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658165453014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,10 @@\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n-        next(rows[0]);\r\n+        req.data = [rows[0]];\r\n+        next();\r\n     }\r\n }\r\n \r\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658165690956,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('admin');\r\n+        res.redirect('/');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658165707836,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('/');\r\n+        res.redirect('admin/login'));\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658165724272,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('admin/login'));\r\n+        res.redirect('/login');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658165739204,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('/login');\r\n+        res.redirect('admin');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658165757618,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('admin');\r\n+        res.redirect('/admin/login');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658165816430,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,8 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n     if (!req.cookies.email) {\r\n-        res.redirect('/admin/login');\r\n+        res.redirect('/admin');\r\n         return;\r\n     }\r\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n"
                },
                {
                    "date": 1658166241075,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n+    console.log(req.session);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166456784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(req.session);\r\n+    console.log(req.se);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166563769,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(req.se);\r\n+    console.log(req.query);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166592281,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(req.query);\r\n+    console.log(\"check querry >>>>\", req.query);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166619565,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(\"check querry >>>>\", req.query);\r\n+    console.log(\"check querry >>>>\");\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166718698,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(\"check querry >>>>\");\r\n+    console.log(\"check querry >>>>\", req.query);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166891124,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(\"check querry >>>>\", req.query);\r\n+    console.log(\"check querryfasdfasdfasdfasdfasdfsadfasdfasdfsd >>>>\", req.query);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658166901799,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(\"check querryfasdfasdfasdfasdfasdfsadfasdfasdfsd >>>>\", req.query);\r\n     if (!req.cookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658211314761,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n     const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n         req.data = [rows[0]];\r\n+        res.locals.user = rows[0];\r\n         next();\r\n     }\r\n }\r\n \r\n"
                },
                {
                    "date": 1658211968343,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,11 +1,11 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    if (!req.cookies.email) {\r\n+    if (!req.signedCookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n-    const sql = `SELECT * FROM thanhvien WHERE email = '${req.cookies.email}'`;\r\n+    const sql = `SELECT * FROM thanhvien WHERE email = '${req.signedCookies.email}'`;\r\n     const [rows] = await pool.query(sql);\r\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n         req.data = [rows[0]];\r\n         res.locals.user = rows[0];\r\n"
                },
                {
                    "date": 1658212072033,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n+    console.log(req.cookies.email, req.signedCookies.email));\r\n     if (!req.signedCookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658212128848,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n-    console.log(req.cookies.email, req.signedCookies.email));\r\n     if (!req.signedCookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658212698366,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n import pool from '../config/connectDatabase'\r\n const requireAuth = async (req, res, next) => {\r\n+    console.log(req.signedCookies);\r\n     if (!req.signedCookies.email) {\r\n         res.redirect('/admin');\r\n         return;\r\n     }\r\n"
                },
                {
                    "date": 1658217135166,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,9 @@\n     const [rows] = await pool.query(sql);\r\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n         req.data = [rows[0]];\r\n         res.locals.user = rows[0];\r\n+        res.locals.query = req.query;\r\n         next();\r\n     }\r\n }\r\n \r\n"
                },
                {
                    "date": 1658217234216,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,8 +10,9 @@\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n         req.data = [rows[0]];\r\n         res.locals.user = rows[0];\r\n         res.locals.query = req.query;\r\n+        console.log(res.locals.query);\r\n         next();\r\n     }\r\n }\r\n \r\n"
                },
                {
                    "date": 1658217261172,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,8 @@\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n         req.data = [rows[0]];\r\n         res.locals.user = rows[0];\r\n         res.locals.query = req.query;\r\n-        console.log(res.locals.query);\r\n         next();\r\n     }\r\n }\r\n \r\n"
                },
                {
                    "date": 1658221777945,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,18 +1,18 @@\n-import pool from '../config/connectDatabase'\r\n-const requireAuth = async (req, res, next) => {\r\n-    console.log(req.signedCookies);\r\n-    if (!req.signedCookies.email) {\r\n-        res.redirect('/admin');\r\n-        return;\r\n-    }\r\n-    const sql = `SELECT * FROM thanhvien WHERE email = '${req.signedCookies.email}'`;\r\n-    const [rows] = await pool.query(sql);\r\n-    if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\r\n-        req.data = [rows[0]];\r\n-        res.locals.user = rows[0];\r\n-        res.locals.query = req.query;\r\n-        next();\r\n-    }\r\n-}\r\n-\r\n+import pool from '../config/connectDatabase'\n+const requireAuth = async (req, res, next) => {\n+    console.log(req.signedCookies);\n+    if (!req.signedCookies.email) {\n+        res.redirect('/admin');\n+        return;\n+    }\n+    const sql = `SELECT * FROM thanhvien WHERE email = '${req.signedCookies.email}'`;\n+    const [rows] = await pool.query(sql);\n+    if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\n+        req.data = [rows[0]];\n+        res.locals.user = rows[0];\n+        res.locals.query = req.query;\n+        next();\n+    }\n+}\n+\n module.exports = { requireAuth };\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658222411426,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,8 @@\n     const [rows] = await pool.query(sql);\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\n         req.data = [rows[0]];\n         res.locals.user = rows[0];\n-        res.locals.query = req.query;\n         next();\n     }\n }\n \n"
                },
                {
                    "date": 1658222770077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,9 @@\n     const [rows] = await pool.query(sql);\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\n         req.data = [rows[0]];\n         res.locals.user = rows[0];\n+        res.locals.query = req.query;\n         next();\n     }\n }\n \n"
                },
                {
                    "date": 1658222871601,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,8 @@\n     const [rows] = await pool.query(sql);\n     if (rows.length > 0 && rows[0].quyen_truy_cap === 2) {\n         req.data = [rows[0]];\n         res.locals.user = rows[0];\n-        res.locals.query = req.query;\n         next();\n     }\n }\n \n"
                },
                {
                    "date": 1658223076730,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,6 @@\n import pool from '../config/connectDatabase'\n const requireAuth = async (req, res, next) => {\n-    console.log(req.signedCookies);\n     if (!req.signedCookies.email) {\n         res.redirect('/admin');\n         return;\n     }\n"
                }
            ],
            "date": 1658163385479,
            "name": "Commit-0",
            "content": "const requireAuth = (req, res, next) => {\r\n\r\n}"
        }
    ]
}