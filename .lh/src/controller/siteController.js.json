{
    "sourceFile": "src/controller/siteController.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 111,
            "patches": [
                {
                    "date": 1658155698655,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1658155716838,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n import pool from '../config/connectDatabase'\r\n //[GET]\r\n class SiteController {\r\n     getHomepage = async (req, res) => {\r\n-        return res.render('index.ejs', { dataUser: rows })\r\n+        return res.render('index.ejs')\r\n     }\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1658452541760,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,10 +1,33 @@\n import pool from '../config/connectDatabase'\r\n //[GET]\r\n class SiteController {\r\n     getHomepage = async (req, res) => {\r\n-        return res.render('index.ejs')\r\n+        const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n+        const [rows] = await pool.query(sql)\r\n+        console.log(rows);\r\n+        res.render('pages/index.ejs', {\r\n+            products: rows,\r\n+            url: req.url //url cua trang hien tai\r\n+        });\r\n     }\r\n+\r\n+    //GET DETIAL PRODUCT\r\n+    getDetailProduct = async (req, res) => {\r\n+        const id = req.params.id;\r\n+        const sql = `SELECT * FROM sanpham WHERE id_sp = ${id}`;\r\n+        const [rows] = await pool.query(sql);\r\n+        if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n+            console.log(rows[0]);\r\n+            res.render('pages/index.ejs', {\r\n+                dataDetail: rows[0],\r\n+                url: \"detail-product\"\r\n+            });\r\n+        }\r\n+        else {\r\n+            res.render('pages/404.ejs');\r\n+        }\r\n+    }\r\n }\r\n \r\n \r\n module.exports = new SiteController;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658452573366,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,9 @@\n class SiteController {\r\n     getHomepage = async (req, res) => {\r\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n         const [rows] = await pool.query(sql)\r\n-        console.log(rows);\r\n+        console.log(\"Checkk query >>>>>>>>>>>\", req.query);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             url: req.url //url cua trang hien tai\r\n         });\r\n"
                },
                {
                    "date": 1658452597713,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,8 @@\n class SiteController {\r\n     getHomepage = async (req, res) => {\r\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n         const [rows] = await pool.query(sql)\r\n-        console.log(\"Checkk query >>>>>>>>>>>\", req.query);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             url: req.url //url cua trang hien tai\r\n         });\r\n"
                },
                {
                    "date": 1658452619977,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n-            url: req.url //url cua trang hien tai\r\n+            url: req.query.page_layout //url cua trang hien tai\r\n         });\r\n     }\r\n \r\n     //GET DETIAL PRODUCT\r\n"
                },
                {
                    "date": 1658452639396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n-            url: req.query.page_layout //url cua trang hien tai\r\n+            url: req.url //url cua trang hien tai\r\n         });\r\n     }\r\n \r\n     //GET DETIAL PRODUCT\r\n"
                },
                {
                    "date": 1658452649402,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n             console.log(rows[0]);\r\n             res.render('pages/index.ejs', {\r\n                 dataDetail: rows[0],\r\n-                url: \"detail-product\"\r\n+                url: req.query.page_layout\r\n             });\r\n         }\r\n         else {\r\n             res.render('pages/404.ejs');\r\n"
                },
                {
                    "date": 1658452674518,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,10 +11,9 @@\n     }\r\n \r\n     //GET DETIAL PRODUCT\r\n     getDetailProduct = async (req, res) => {\r\n-        const id = req.params.id;\r\n-        const sql = `SELECT * FROM sanpham WHERE id_sp = ${id}`;\r\n+        const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\r\n         const [rows] = await pool.query(sql);\r\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n             console.log(rows[0]);\r\n             res.render('pages/index.ejs', {\r\n"
                },
                {
                    "date": 1658452821925,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,8 @@\n     getDetailProduct = async (req, res) => {\r\n         const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\r\n         const [rows] = await pool.query(sql);\r\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n-            console.log(rows[0]);\r\n             res.render('pages/index.ejs', {\r\n                 dataDetail: rows[0],\r\n                 url: req.query.page_layout\r\n             });\r\n"
                },
                {
                    "date": 1658452834719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,8 +13,9 @@\n     //GET DETIAL PRODUCT\r\n     getDetailProduct = async (req, res) => {\r\n         const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\r\n         const [rows] = await pool.query(sql);\r\n+        console.log(req.query);\r\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n             res.render('pages/index.ejs', {\r\n                 dataDetail: rows[0],\r\n                 url: req.query.page_layout\r\n"
                },
                {
                    "date": 1658452870781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n     //GET DETIAL PRODUCT\r\n     getDetailProduct = async (req, res) => {\r\n         const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\r\n         const [rows] = await pool.query(sql);\r\n-        console.log(req.query);\r\n+        console.log(\"check query>>>>>>>>>\", req.query);\r\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n             res.render('pages/index.ejs', {\r\n                 dataDetail: rows[0],\r\n                 url: req.query.page_layout\r\n"
                },
                {
                    "date": 1658453216699,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n-            url: req.url //url cua trang hien tai\r\n+            page_layout: req.url //url cua trang hien tai\r\n         });\r\n     }\r\n \r\n     //GET DETIAL PRODUCT\r\n@@ -17,9 +17,9 @@\n         console.log(\"check query>>>>>>>>>\", req.query);\r\n         if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n             res.render('pages/index.ejs', {\r\n                 dataDetail: rows[0],\r\n-                url: req.query.page_layout\r\n+                page_layout: req.query.page_layout\r\n             });\r\n         }\r\n         else {\r\n             res.render('pages/404.ejs');\r\n"
                },
                {
                    "date": 1658453868429,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -24,8 +24,19 @@\n         else {\r\n             res.render('pages/404.ejs');\r\n         }\r\n     }\r\n+\r\n+    //GET PRODUCTS\r\n+    getProducts = async (req, res) => {\r\n+\r\n+        const sql = `SELECT * FROM sanpham`\r\n+        const [rows] = await pool.query(sql)\r\n+        res.render('pages/index.ejs', {\r\n+            products: rows,\r\n+            page_layout: req.query.page_layout\r\n+        });\r\n+    }\r\n }\r\n \r\n \r\n module.exports = new SiteController;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658453993551,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n \r\n-        const sql = `SELECT * FROM sanpham`\r\n+        const sql = `SELECT ,* FROM sanpham`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             page_layout: req.query.page_layout\r\n"
                },
                {
                    "date": 1658454002781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n \r\n-        const sql = `SELECT ,* FROM sanpham`\r\n+        const sql = `SELECT danhmuc.,* FROM sanpham`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             page_layout: req.query.page_layout\r\n"
                },
                {
                    "date": 1658454009641,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n \r\n-        const sql = `SELECT danhmuc.,* FROM sanpham`\r\n+        const sql = `SELECT danhmuc.ten_dm,* FROM sanpham`\r\n         const [rows] = await pool.query(sql)\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             page_layout: req.query.page_layout\r\n"
                },
                {
                    "date": 1658454083443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,11 +27,12 @@\n     }\r\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n-\r\n-        const sql = `SELECT danhmuc.ten_dm,* FROM sanpham`\r\n+        //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n+        const sql = `SELECT * FROM sanpham INNER JOIN danhmuc ON sanpham.id_dm = danhmuc.id_dm`;\r\n         const [rows] = await pool.query(sql)\r\n+        console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n             page_layout: req.query.page_layout\r\n         });\r\n"
                },
                {
                    "date": 1658454204809,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n-        const sql = `SELECT * FROM sanpham INNER JOIN danhmuc ON sanpham.id_dm = danhmuc.id_dm`;\r\n+        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = danhmuc.id_dm`;\r\n         const [rows] = await pool.query(sql)\r\n         console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n"
                },
                {
                    "date": 1658454213553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n-        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = danhmuc.id_dm`;\r\n+        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = dm_sanpham.id_dm`;\r\n         const [rows] = await pool.query(sql)\r\n         console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n"
                },
                {
                    "date": 1658454264363,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n-        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = dm_sanpham.id_dm`;\r\n+        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = dmsanpham.id_dm`;\r\n         const [rows] = await pool.query(sql)\r\n         console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n"
                },
                {
                    "date": 1658454367078,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,9 +28,9 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n-        const sql = `SELECT * FROM sanpham INNER JOIN dm_sanpham ON sanpham.id_dm = dmsanpham.id_dm`;\r\n+        const sql = `SELECT * FROM sanpham  JOIN dm_sanpham ON sanpham.id_dm = dmsanpham.id_dm`;\r\n         const [rows] = await pool.query(sql)\r\n         console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n"
                },
                {
                    "date": 1658454408991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,10 +27,11 @@\n     }\r\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n-        //join danhmuc on sanpham.id_dm = danhmuc.id_dm \r\n-        const sql = `SELECT * FROM sanpham  JOIN dm_sanpham ON sanpham.id_dm = dmsanpham.id_dm`;\r\n+        //get category and sanpham\r\n+        const sql = `SELECT * FROM danhmucsp`;\r\n+\r\n         const [rows] = await pool.query(sql)\r\n         console.log(rows);\r\n         res.render('pages/index.ejs', {\r\n             products: rows,\r\n"
                },
                {
                    "date": 1658454523071,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -27,15 +27,17 @@\n     }\r\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n-        //get category and sanpham\r\n-        const sql = `SELECT * FROM danhmucsp`;\r\n-\r\n-        const [rows] = await pool.query(sql)\r\n-        console.log(rows);\r\n+        //get danhmusp and sanpham\r\n+        const id = req.query.id;\r\n+        const sql = `SELECT * FROM danhmusp`;\r\n+        const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n+        const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n+        //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n-            products: rows,\r\n+            danhmusp: rows1,\r\n+            sanpham: rows2,\r\n             page_layout: req.query.page_layout\r\n         });\r\n     }\r\n }\r\n"
                },
                {
                    "date": 1658454553718,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,8 +32,9 @@\n         const id = req.query.id;\r\n         const sql = `SELECT * FROM danhmusp`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n+        console.log(\"check query>>>>>>>>>\", rows2);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1,\r\n             sanpham: rows2,\r\n"
                },
                {
                    "date": 1658454566393,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,9 +29,9 @@\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id;\r\n-        const sql = `SELECT * FROM danhmusp`;\r\n+        const sql = `SELECT * FROM danhmusp WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2);\r\n         //get danhmusp and sanpham\r\n"
                },
                {
                    "date": 1658454605545,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,9 +29,9 @@\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id;\r\n-        const sql = `SELECT * FROM danhmusp WHERE id_dm = ${id}`;\r\n+        const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2);\r\n         //get danhmusp and sanpham\r\n"
                },
                {
                    "date": 1658454620640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,19 +28,19 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n-        const id = req.query.id;\r\n-        const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n-        const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows2);\r\n-        //get danhmusp and sanpham\r\n-        res.render('pages/index.ejs', {\r\n-            danhmusp: rows1,\r\n-            sanpham: rows2,\r\n-            page_layout: req.query.page_layout\r\n-        });\r\n+        const id = req.query;\r\n+        // const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n+        // const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n+        // const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n+        // console.log(\"check query>>>>>>>>>\", rows2);\r\n+        // //get danhmusp and sanpham\r\n+        // res.render('pages/index.ejs', {\r\n+        //     danhmusp: rows1,\r\n+        //     sanpham: rows2,\r\n+        //     page_layout: req.query.page_layout\r\n+        // });\r\n     }\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1658454638500,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query;\r\n         // const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n         // const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         // const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        // console.log(\"check query>>>>>>>>>\", rows2);\r\n+        console.log(\"check query>>>>>>>>>\", req.query);\r\n         // //get danhmusp and sanpham\r\n         // res.render('pages/index.ejs', {\r\n         //     danhmusp: rows1,\r\n         //     sanpham: rows2,\r\n"
                },
                {
                    "date": 1658454661188,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -28,13 +28,13 @@\n \r\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n-        const id = req.query;\r\n-        // const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n-        // const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n-        // const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", req.query);\r\n+        const id = req.query.id_dm;\r\n+        const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n+        const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n+        const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n+        console.log(\"check query>>>>>>>>>\", req.rows2);\r\n         // //get danhmusp and sanpham\r\n         // res.render('pages/index.ejs', {\r\n         //     danhmusp: rows1,\r\n         //     sanpham: rows2,\r\n"
                },
                {
                    "date": 1658454713971,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -29,9 +29,9 @@\n     //GET PRODUCTS\r\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n-        const sql = `SELECT * FROM danhmucsp WHERE id_dm = ${id}`;\r\n+        const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", req.rows2);\r\n         // //get danhmusp and sanpham\r\n"
                },
                {
                    "date": 1658454786858,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -33,14 +33,14 @@\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", req.rows2);\r\n-        // //get danhmusp and sanpham\r\n-        // res.render('pages/index.ejs', {\r\n-        //     danhmusp: rows1,\r\n-        //     sanpham: rows2,\r\n-        //     page_layout: req.query.page_layout\r\n-        // });\r\n+        //get danhmusp and sanpham\r\n+        res.render('pages/index.ejs', {\r\n+            danhmusp: rows1,\r\n+            sanpham: rows2,\r\n+            page_layout: req.query.page_layout\r\n+        });\r\n     }\r\n }\r\n \r\n \r\n"
                },
                {
                    "date": 1658454835887,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", req.rows2);\r\n+        console.log(\"check query>>>>>>>>>\",req.query.page_layout);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1,\r\n             sanpham: rows2,\r\n"
                },
                {
                    "date": 1658454895811,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\",req.query.page_layout);\r\n+        console.log(\"check query>>>>>>>>>\", rows1);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1,\r\n             sanpham: rows2,\r\n"
                },
                {
                    "date": 1658454927917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,13 +32,13 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n-            danhmusp: rows1,\r\n-            sanpham: rows2,\r\n+            danhmusp: rows1[0],\r\n+            sanpham: rows2[0],\r\n             page_layout: req.query.page_layout\r\n         });\r\n     }\r\n }\r\n"
                },
                {
                    "date": 1658454944342,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658454991024,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham where id_dm = ${id}`;\r\n+        const sql2 = `SELECT * FROM sanpham where`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n"
                },
                {
                    "date": 1658455007184,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham where`;\r\n+        const sql2 = `SELECT * FROM sanpham`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n"
                },
                {
                    "date": 1658455032184,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham`;\r\n+        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n"
                },
                {
                    "date": 1658455210906,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n+        const sql2 = `SELECT * FROM sanpham`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n"
                },
                {
                    "date": 1658455246941,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,11 +30,11 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham`;\r\n+        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows2);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455267353,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows2);\r\n+        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455312133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0], row2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455507511,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0], row2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmusp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455516667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -35,9 +35,9 @@\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n-            danhmusp: rows1[0],\r\n+            danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n             page_layout: req.query.page_layout\r\n         });\r\n     }\r\n"
                },
                {
                    "date": 1658455872481,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455939593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455976548,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0].ten_dm, rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658455997531,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0].ten_dm, rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658456007934,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0], rows2[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658456023277,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0].ten_dm);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658456035847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0].ten_dm);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0][0]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658456048079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,9 +32,9 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0][0]);\r\n+        console.log(\"check query>>>>>>>>>\", rows1[0][0].ten_dm);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0],\r\n             sanpham: rows2[0],\r\n"
                },
                {
                    "date": 1658456068626,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -32,12 +32,11 @@\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n         const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        console.log(\"check query>>>>>>>>>\", rows1[0][0].ten_dm);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n-            danhmucsp: rows1[0],\r\n+            danhmucsp: rows1[0][0],\r\n             sanpham: rows2[0],\r\n             page_layout: req.query.page_layout\r\n         });\r\n     }\r\n"
                },
                {
                    "date": 1658457753149,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,9 @@\n     getProducts = async (req, res) => {\r\n         //get danhmusp and sanpham\r\n         const id = req.query.id_dm;\r\n         const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id}`;\r\n+        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id} ORDER BY id_sp DESC`;\r\n         const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n         //get danhmusp and sanpham\r\n         res.render('pages/index.ejs', {\r\n             danhmucsp: rows1[0][0],\r\n"
                },
                {
                    "date": 1658466636627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,46 +1,45 @@\n-import pool from '../config/connectDatabase'\r\n-//[GET]\r\n-class SiteController {\r\n-    getHomepage = async (req, res) => {\r\n-        const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\r\n-        const [rows] = await pool.query(sql)\r\n-        res.render('pages/index.ejs', {\r\n-            products: rows,\r\n-            page_layout: req.url //url cua trang hien tai\r\n-        });\r\n-    }\r\n-\r\n-    //GET DETIAL PRODUCT\r\n-    getDetailProduct = async (req, res) => {\r\n-        const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\r\n-        const [rows] = await pool.query(sql);\r\n-        console.log(\"check query>>>>>>>>>\", req.query);\r\n-        if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\r\n-            res.render('pages/index.ejs', {\r\n-                dataDetail: rows[0],\r\n-                page_layout: req.query.page_layout\r\n-            });\r\n-        }\r\n-        else {\r\n-            res.render('pages/404.ejs');\r\n-        }\r\n-    }\r\n-\r\n-    //GET PRODUCTS\r\n-    getProducts = async (req, res) => {\r\n-        //get danhmusp and sanpham\r\n-        const id = req.query.id_dm;\r\n-        const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\r\n-        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id} ORDER BY id_sp DESC`;\r\n-        const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\r\n-        //get danhmusp and sanpham\r\n-        res.render('pages/index.ejs', {\r\n-            danhmucsp: rows1[0][0],\r\n-            sanpham: rows2[0],\r\n-            page_layout: req.query.page_layout\r\n-        });\r\n-    }\r\n-}\r\n-\r\n-\r\n+import pool from '../config/connectDatabase'\n+//[GET]\n+class SiteController {\n+    getHomepage = async (req, res) => {\n+        const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\n+        const [rows] = await pool.query(sql)\n+        res.render('pages/index.ejs', {\n+            products: rows,\n+            page_layout: req.url //url cua trang hien tai\n+        });\n+    }\n+\n+    //GET DETIAL PRODUCT\n+    getDetailProduct = async (req, res) => {\n+        const sql = `SELECT * FROM sanpham WHERE id_sp = ${req.query.id}`;\n+        const [rows] = await pool.query(sql);\n+        if (rows[0] !== undefined || rows[0] !== null || rows[0] !== '' || rows[0] !== 0 || rows[0] !== '0') {\n+            res.render('pages/index.ejs', {\n+                dataDetail: rows[0],\n+                page_layout: req.query.page_layout\n+            });\n+        }\n+        else {\n+            res.render('pages/404.ejs');\n+        }\n+    }\n+\n+    //GET PRODUCTS\n+    getProducts = async (req, res) => {\n+        //get danhmusp and sanpham\n+        const id = req.query.id_dm;\n+        const sql = `SELECT * FROM dmsanpham WHERE id_dm = ${id}`;\n+        const sql2 = `SELECT * FROM sanpham WHERE id_dm = ${id} ORDER BY id_sp DESC`;\n+        const [rows1, rows2] = await Promise.all([pool.query(sql), pool.query(sql2)]);\n+        //get danhmusp and sanpham\n+        res.render('pages/index.ejs', {\n+            danhmucsp: rows1[0][0],\n+            sanpham: rows2[0],\n+            page_layout: req.query.page_layout\n+        });\n+    }\n+}\n+\n+\n module.exports = new SiteController;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658467883004,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,12 @@\n import pool from '../config/connectDatabase'\n //[GET]\n class SiteController {\n     getHomepage = async (req, res) => {\n+        //pagination product\n+        const page = parseInt(req.query.page) || 1;\n+        const perPage = 8;\n+        const start = (page - 1) * perPage;\n         const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\n         const [rows] = await pool.query(sql)\n         res.render('pages/index.ejs', {\n             products: rows,\n"
                },
                {
                    "date": 1658468299769,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,13 +5,17 @@\n         //pagination product\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n-        const sql = `SELECT * FROM sanpham ORDER BY id_sp DESC LIMIT 8`\n-        const [rows] = await pool.query(sql)\n-        res.render('pages/index.ejs', {\n-            products: rows,\n-            page_layout: req.url //url cua trang hien tai\n+        const end = page * perPage;\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products')[0].total / perPage);\n+        const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n+        //render(products)\n+        res.render('index', {\n+            products,\n+            page,\n+            totalPage,\n+            page_layout: '/'\n         });\n     }\n \n     //GET DETIAL PRODUCT\n"
                },
                {
                    "date": 1658468313569,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,8 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products')[0].total / perPage);\n+\n         const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n             products,\n"
                },
                {
                    "date": 1658468390279,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products')[0].total / perPage);\n-\n+        console.log(totalPage);\n         const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n             products,\n"
                },
                {
                    "date": 1658468463896,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products')[0].total / perPage);\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products'));\n         console.log(totalPage);\n         const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n"
                },
                {
                    "date": 1658468484847,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM products'));\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0].total / perPage);\n         console.log(totalPage);\n         const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n"
                },
                {
                    "date": 1658468504784,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0].total / perPage);\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n         console.log(totalPage);\n         const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n"
                },
                {
                    "date": 1658468538128,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n         console.log(totalPage);\n-        const products = await pool.query('SELECT * FROM products LIMIT ?, ?', [start, end]);\n+        const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('index', {\n             products,\n             page,\n"
                },
                {
                    "date": 1658468565916,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n         console.log(totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n-        res.render('index', {\n+        res.render('/pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n             page_layout: '/'\n"
                },
                {
                    "date": 1658468588327,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,9 +10,9 @@\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n         console.log(totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n-        res.render('/pages/index.ejs', {\n+        res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n             page_layout: '/'\n"
                },
                {
                    "date": 1658468645849,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n-        console.log(totalPage);\n+        console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658468701046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham')[0] / perPage);\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham') / perPage);\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658468719573,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham') / perPage);\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham'));\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658468745394,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) as total FROM sanpham'));\n+        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) FROM sanpham'));\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658468924240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.query('SELECT COUNT(*) FROM sanpham'));\n+        const totalPage = Math.ceil(await pool.execute('SELECT COUNT(*) FROM sanpham'));\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469031009,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.execute('SELECT COUNT(*) FROM sanpham'));\n+        const totalPage = Math.ceil(await pool.execute('SELECT COUNT(*) FROM `sanpham`'));\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469168561,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,10 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = Math.ceil(await pool.execute('SELECT COUNT(*) FROM `sanpham`'));\n+        const totalPage = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n+        console.log(totalPage);\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469198639,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(totalPage);\n+        console.log(totalPage[0].count);\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469219017,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(totalPage[0].count);\n+        console.log(totalPage[0]);\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469245318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,8 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const totalPage = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(totalPage[0]);\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469275237,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const totalPage = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n+        const [totalPag]] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469303092,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const [totalPag]] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n+        const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         console.log(\"total>>>\", totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658469320885,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", totalPage);\n+        console.log(\"total>>>\", totalPage.count);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658469343631,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", totalPage.count);\n+        console.log(\"total>>>\", totalPage[0].count);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658469355917,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", totalPage[0].count);\n+        console.log(\"total>>>\", totalPage.COUNT);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658469372089,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,9 +7,9 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", totalPage.COUNT);\n+        console.log(\"total>>>\", totalPage[0].COUNT);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658469413252,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,10 +6,10 @@\n         const page = parseInt(req.query.page) || 1;\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n-        const [totalPage] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", totalPage[0].COUNT);\n+        const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n+        console.log(\"total>>>\", Count[0]['COUNT(*)']);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n"
                },
                {
                    "date": 1658469447373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n             page,\n-            totalPage,\n+            // totalPage,\n             page_layout: '/'\n         });\n     }\n \n"
                },
                {
                    "date": 1658469486902,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,15 +7,15 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        console.log(\"total>>>\", Count[0]['COUNT(*)']);\n+        const total = Count[0]['COUNT(*)'];\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n             page,\n-            // totalPage,\n+            total,\n             page_layout: '/'\n         });\n     }\n \n"
                },
                {
                    "date": 1658469542831,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -7,15 +7,16 @@\n         const perPage = 8;\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n-        const total = Count[0]['COUNT(*)'];\n+        const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n+        console.log(totalPage);\n         const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         //render(products)\n         res.render('pages/index.ejs', {\n             products,\n             page,\n-            total,\n+            totalPage,\n             page_layout: '/'\n         });\n     }\n \n"
                },
                {
                    "date": 1658469577143,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,11 +8,10 @@\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n-        console.log(totalPage);\n-        const products = await pool.query('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n-        //render(products)\n+        const products = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n+        console.log(products);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658469596046,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,9 +8,9 @@\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n-        const products = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n+        const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n         console.log(products);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n"
                },
                {
                    "date": 1658469622923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n-        console.log(products);\n+        console.log(products[0]);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658469689107,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,8 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n-        console.log(products[0]);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658469780677,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,8 +9,9 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n+        console.log(products);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658469816542,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n-        console.log(products);\n+        console.log(page);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658469833454,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,8 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham`');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [products] = await pool.execute('SELECT * FROM sanpham LIMIT ?, ?', [start, end]);\n-        console.log(page);\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658472158790,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -46,8 +46,19 @@\n             sanpham: rows2[0],\n             page_layout: req.query.page_layout\n         });\n     }\n+\n+    //GET SEARCH\n+    getSearch = async (req, res) => {\n+        const search = req.query.search;\n+        const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n+        const [rows] = await pool.query(sql);\n+        res.render('pages/index.ejs', {\n+            sanpham: rows,\n+            page_layout: req.query.page_layout\n+        });\n+    }\n }\n \n \n module.exports = new SiteController;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1658472233011,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,8 +52,9 @@\n     getSearch = async (req, res) => {\n         const search = req.query.search;\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n+        console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n             page_layout: req.query.page_layout\n         });\n"
                },
                {
                    "date": 1658472258321,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n-            sanpham: rows,\n+            data: rows,\n             page_layout: req.query.page_layout\n         });\n     }\n }\n"
                },
                {
                    "date": 1658472276555,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,9 @@\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n-            data: rows,\n+            sanpham: rows,\n             page_layout: req.query.page_layout\n         });\n     }\n }\n"
                },
                {
                    "date": 1658472608994,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n-            page_layout: req.query.page_layout\n+            page_layout: \"/search?search=\" + search\n         });\n     }\n }\n \n"
                },
                {
                    "date": 1658472642509,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -55,9 +55,9 @@\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n-            page_layout: \"/search?search=\" + search\n+            page_layout: \"search\"\n         });\n     }\n }\n \n"
                },
                {
                    "date": 1658473781622,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,9 +49,10 @@\n     }\n \n     //GET SEARCH\n     getSearch = async (req, res) => {\n-        const search = req.query.search;\n+        let search = req.query.search;\n+        search = search.replace(/\\s/g, '%');\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658473792739,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,8 +51,9 @@\n     //GET SEARCH\n     getSearch = async (req, res) => {\n         let search = req.query.search;\n         search = search.replace(/\\s/g, '%');\n+        console.log(search);\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n"
                },
                {
                    "date": 1658473899045,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n \n     //GET SEARCH\n     getSearch = async (req, res) => {\n         let search = req.query.search;\n-        search = search.replace(/\\s/g, '%');\n+        // search = search.replace(/\\s/g, '%');\n         console.log(search);\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n"
                },
                {
                    "date": 1658473956022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,13 +50,13 @@\n \n     //GET SEARCH\n     getSearch = async (req, res) => {\n         let search = req.query.search;\n-        // search = search.replace(/\\s/g, '%');\n-        console.log(search);\n+        search = search.replace(/\\s/g, '%');\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n+        console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n             page_layout: \"search\"\n         });\n"
                },
                {
                    "date": 1658474051189,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,9 +54,8 @@\n         search = search.replace(/\\s/g, '%');\n         const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n-        console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n             page_layout: \"search\"\n         });\n"
                },
                {
                    "date": 1658474189603,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,9 +51,9 @@\n     //GET SEARCH\n     getSearch = async (req, res) => {\n         let search = req.query.search;\n         search = search.replace(/\\s/g, '%');\n-        const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%'`;\n+        const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%' ORDER BY id_sp DESC`;\n         const [rows] = await pool.query(sql);\n         console.log(rows);\n         res.render('pages/index.ejs', {\n             sanpham: rows,\n"
                },
                {
                    "date": 1658474419435,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,14 +51,21 @@\n     //GET SEARCH\n     getSearch = async (req, res) => {\n         let search = req.query.search;\n         search = search.replace(/\\s/g, '%');\n-        const sql = `SELECT * FROM sanpham WHERE ten_sp LIKE '%${search}%' ORDER BY id_sp DESC`;\n-        const [rows] = await pool.query(sql);\n-        console.log(rows);\n+        //pagegination product\n+        const page = parseInt(req.query.page) || 1;\n+        const perPage = 8;\n+        const start = (page - 1) * perPage;\n+        const end = page * perPage;\n+        const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham` WHERE ten_sp LIKE \"%' + search + '%\"');\n+        const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n+        const [products] = await pool.execute('SELECT * FROM sanpham WHERE ten_sp LIKE \"%' + search + '%\" LIMIT ?, ?', [start, end]);\n         res.render('pages/index.ejs', {\n-            sanpham: rows,\n-            page_layout: \"search\"\n+            products,\n+            page,\n+            totalPage,\n+            page_layout: '/search?search=' + search\n         });\n     }\n }\n \n"
                },
                {
                    "date": 1658474432560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n         res.render('pages/index.ejs', {\n             products,\n             page,\n             totalPage,\n-            page_layout: '/search?search=' + search\n+            page_layout: 'search'\n         });\n     }\n }\n \n"
                },
                {
                    "date": 1658474450991,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -58,11 +58,11 @@\n         const start = (page - 1) * perPage;\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham` WHERE ten_sp LIKE \"%' + search + '%\"');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n-        const [products] = await pool.execute('SELECT * FROM sanpham WHERE ten_sp LIKE \"%' + search + '%\" LIMIT ?, ?', [start, end]);\n+        const [sanpham] = await pool.execute('SELECT * FROM sanpham WHERE ten_sp LIKE \"%' + search + '%\" LIMIT ?, ?', [start, end]);\n         res.render('pages/index.ejs', {\n-            products,\n+            sanpham,\n             page,\n             totalPage,\n             page_layout: 'search'\n         });\n"
                },
                {
                    "date": 1658475223610,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,8 +63,9 @@\n         res.render('pages/index.ejs', {\n             sanpham,\n             page,\n             totalPage,\n+            search,\n             page_layout: 'search'\n         });\n     }\n }\n"
                },
                {
                    "date": 1658476061631,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -63,9 +63,9 @@\n         res.render('pages/index.ejs', {\n             sanpham,\n             page,\n             totalPage,\n-            search,\n+            search: req.query.search,\n             page_layout: 'search'\n         });\n     }\n }\n"
                },
                {
                    "date": 1658476290719,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,8 +59,9 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham` WHERE ten_sp LIKE \"%' + search + '%\"');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [sanpham] = await pool.execute('SELECT * FROM sanpham WHERE ten_sp LIKE \"%' + search + '%\" LIMIT ?, ?', [start, end]);\n+        console.log(\"page>>>\", page, \"sanpham>>>\", sanpham);\n         res.render('pages/index.ejs', {\n             sanpham,\n             page,\n             totalPage,\n"
                },
                {
                    "date": 1658476354022,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -59,9 +59,8 @@\n         const end = page * perPage;\n         const [Count] = await pool.execute('SELECT COUNT(*) FROM `sanpham` WHERE ten_sp LIKE \"%' + search + '%\"');\n         const totalPage = Math.ceil(Count[0]['COUNT(*)'] / perPage);\n         const [sanpham] = await pool.execute('SELECT * FROM sanpham WHERE ten_sp LIKE \"%' + search + '%\" LIMIT ?, ?', [start, end]);\n-        console.log(\"page>>>\", page, \"sanpham>>>\", sanpham);\n         res.render('pages/index.ejs', {\n             sanpham,\n             page,\n             totalPage,\n"
                }
            ],
            "date": 1658155698655,
            "name": "Commit-0",
            "content": "import pool from '../config/connectDatabase'\r\n//[GET]\r\nclass SiteController {\r\n    getHomepage = async (req, res) => {\r\n        return res.render('index.ejs', { dataUser: rows })\r\n    }\r\n}\r\n\r\n\r\nmodule.exports = new SiteController;"
        }
    ]
}